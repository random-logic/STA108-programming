```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r Function}
r_matrix_to_mathjax <- function(mat) {
  nrow <- dim(mat)[1]

  result <- "\\begin{bmatrix}"
  for (i in 1:nrow) {
    result <- paste(result, "", paste(mat[i, ], collapse = "&"), "\\\\")
  }
  result <- paste(result, "\\end{bmatrix}")

  return(result)
}
```

# 5.5
```{r 5.5}
x1 <- c(4, 1, 2, 3, 3, 4)
Y <- as.matrix(c(16, 5, 10, 15, 13, 22))
X <- cbind(1, x1)

Xt <- t(X)
Yt <- t(Y)
Yt.Y <- Yt %*% Y
Xt.X <- Xt %*% X
Xt.Y <- Xt %*% Y

H <- round(X %*% solve(Xt %*% X) %*% Xt, 4)
H.2 <- round(H %*% H, 4)
```

$X = `r r_matrix_to_mathjax(X)`$

$Y = `r r_matrix_to_mathjax(Y)`$

$Y'Y = `r r_matrix_to_mathjax(Yt)` `r r_matrix_to_mathjax(Y)` = `r r_matrix_to_mathjax(Yt.Y)`$

$X'X = `r r_matrix_to_mathjax(Xt)` `r r_matrix_to_mathjax(X)` = `r r_matrix_to_mathjax(Xt.X)`$

$X'Y = `r r_matrix_to_mathjax(Xt)` `r r_matrix_to_mathjax(Y)` = `r r_matrix_to_mathjax(Xt.Y)`$

$H^2 = `r r_matrix_to_mathjax(H.2)`$

$H = `r r_matrix_to_mathjax(H)`$

$\therefore H^2 = H$

# 5.17.a
$W_1 = \begin{bmatrix} 1 & 1 & 1 \end{bmatrix} Y$

$W_2 = \begin{bmatrix} 1 & -1 & 0 \end{bmatrix} Y$

$W_3 = \begin{bmatrix} 1 & -1 & -1 \end{bmatrix} Y$

# 5.17.b
$W = \begin{bmatrix} W_1 \\ W_2 \\ W_3 \end{bmatrix}$

$E\{W\} = \begin{bmatrix} 
  \mu_1 + \mu_2 + \mu_3 \\
  \mu_1 - \mu_2 \\
  \mu_1 - \mu_2 - \mu_3
  \end{bmatrix}$

# 5.24
??

# 6.1.a
$Y = \beta^T X + \epsilon$

$X = \begin{bmatrix}
  1 & x_{11} & x_{11}x_{12} \\
  1 & x_{21} & x_{21}x_{22} \\
  1 & x_{31} & x_{31}x_{32} \\
  1 & x_{41} & x_{41}x_{42}
  \end{bmatrix}$

$\beta = \begin{bmatrix}
  \beta_0 \\
  \beta_1 \\
  \beta_2
  \end{bmatrix}$

# 6.1.b
$log(Y) = \beta^T X + \epsilon$

$X = \begin{bmatrix}
  1 & x_{11} & x_{12} \\
  1 & x_{21} & x_{22} \\
  1 & x_{31} & x_{32} \\
  1 & x_{41} & x_{42}
  \end{bmatrix}$

$\beta = \begin{bmatrix}
  \beta_0 \\
  \beta_1 \\
  \beta_2
  \end{bmatrix}$

# 6.22.a
This is not a linear regression model. We can apply the following transformations:

$X_{i1}' = X_{i1}$

$X_{i2}' = 10 ^ {X_{i2}}$

$X_{i3}' = X_{i1} ^ 2$

Our linear regression model after the transformation:

$Y_i = \beta_0 + \beta_1 X_{i1}' + \beta_2 X_{i2}' + \beta_3 X_{i3}' + \epsilon_i$

# 6.22.b
This is not a linear regression model. It is not possible to transform this.

# Example 6.9
$b_0:$ The intercept in the linear regression model.

$b_1:$ The slope of $x_1$ in the linear regression model.

$b_2:$ The slope of $x_2$ in the linear regression model.

# Appendix
```{r appendix, results="asis"}
# Get all the labels
all_labels <- knitr::all_labels()

# Print out code along with labels
for (label in all_labels) {
  if (label == "setup" || label == "appendix") {
    next
  }

  code <- knitr::knit_code$get(label)

  cat("```r \n")
  cat("# ", label, "\n", sep = "")
  cat(code, sep = "\n")
  cat("```\n")
}
```